<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <title>anindyabiswas.io</title>
    <link href="http://anindyabiswas.io/feed.xml" rel="self" />
    <link href="http://anindyabiswas.io" />
    <updated>1970-01-01T05:30:00+05:30</updated>
    <author>
        <name>Anindya Biswas</name>
    </author>
    <id>http://anindyabiswas.io</id>

    <entry>
        <title>AWS Ubuntu 18.04 Instance to Azure or VMWare Migration or Any Other Virtualization</title>
        <author>
            <name>Anindya Biswas</name>
        </author>
        <link href="http://anindyabiswas.io/aws-ubuntu-instance-to-azure-or-vmware-migration.html"/>
        <id>http://anindyabiswas.io/aws-ubuntu-instance-to-azure-or-vmware-migration.html</id>
            <category term="Linux"/>
            <category term="Cloud Computing"/>

        <updated>2020-07-03T16:44:07+05:30</updated>
            <summary>
                <![CDATA[
                    Introduction StoryThe company I work for uses AWS as a primary cloud provider. The product that I worked on is a tool that made Mobile applications. Now when we started getting Corporate/Enterprise customers, They started to ask for On Premises deployment on either a VMWare&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <div class="post__toc">
<h3>Table of Contents</h3>
<ul>
<li><a href="#mcetoc_1eca0ciqp2r">Introduction Story</a></li>
<li><a href="#mcetoc_1eca17npv30">The Process</a>
<ul>
<li><a href="#mcetoc_1eca2a6sa35">Step 1: Enable Root Access of AWS Instance via SSH</a></li>
<li><a href="#mcetoc_1eca2dc8a48">Step 2: Stop All Services on AWS Instance</a></li>
<li><a href="#mcetoc_1eca2dc8a49">Step 3: Create Azure Virtual Machine with same version of Ubuntu as AWS</a></li>
<li><a href="#mcetoc_1eca2dc8a4a">Step 4: Start the migration</a></li>
<li><a href="#mcetoc_1eca2dc8a4b">Step 5: Install Azure Kernel</a></li>
<li><a href="#mcetoc_1eca2dc8a4c">Step 6: Perform Cleanup</a></li>
<li><a href="#mcetoc_1eca2dc8a4d">Step 7: Azure Agent</a></li>
</ul>
</li>
<li><a href="#mcetoc_1eca0bf8f2p">References</a></li>
<li><a href="#mcetoc_1eca5jfib4p">Contact Me</a></li>
</ul>
</div>
<h4 id="mcetoc_1eca0ciqp2r">Introduction Story</h4>
<p>The company I work for uses AWS as a primary cloud provider. The product that I worked on is a tool that made Mobile applications. Now when we started getting  Corporate/Enterprise customers, They started to ask for On Premises deployment on either a <strong>VMWare</strong> Environment, <strong>Nutanix</strong> Enterprise Cloud or on their Azure Instances in their accounts. Some organizations used AWS so it was easy, we would just share the AMI for the AWS Images and be done with it. However challenge was when they wanted deployments of production on their cloud or On premises solutions. </p>
<p>After failing a few times I found a way to reliably moving around across any Virtualization System.</p>
<h4 id="mcetoc_1eca17npv30">The Process</h4>
<p>The Idea behind is a simple one. We just copy all the files in root (/) from a <strong>Source</strong> instance to <strong>Destination </strong>Instance.</p>
<p>Here are the steps I performed.</p>
<h5 id="mcetoc_1eca2a6sa35">Step 1: Enable Root Access of AWS Instance via SSH</h5>
<p>On AWS <strong>"root user"</strong> access is restricted via SSH and this is done on purpose for security reasons. However we require root access as we will be copying system level files.</p>
<p>To do this we must do 3 things.</p>
<ul style="list-style-type: square;">
<li><strong>Copy .ssh folder</strong> from Logged in User to /root folder, the purpose for this is to have the same key we use to login.</li>
</ul>
<table style="border-collapse: collapse; background-color: #000000; border-color: #3598db; border-style: outset; height: 10px;" width="699">
<tbody>
<tr>
<th style="width: 700.8px;"><span style="color: #2dc26b;">sudo cp -R .ssh /root</span></th>
</tr>
</tbody>
</table>
<ul style="list-style-type: square;">
<li>Edit <strong>/etc/ssh/sshd_config</strong></li>
</ul>
<table style="border-collapse: collapse; background-color: #000000; border-color: #3598db; border-style: outset; height: 10px;" width="699">
<tbody>
<tr>
<th style="width: 700.8px;"><span style="color: #2dc26b;">sudo sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/' /etc/ssh/sshd_config</span></th>
</tr>
</tbody>
</table>
<ul style="list-style-type: square;">
<li>Restart <strong>SSH Service</strong></li>
</ul>
<table style="border-collapse: collapse; background-color: #000000; border-color: #3598db; border-style: outset; height: 10px;" width="699">
<tbody>
<tr>
<th style="width: 700.8px;"><span style="color: #2dc26b;">sudo service ssh restart</span></th>
</tr>
</tbody>
</table>
<p>That should be it.</p>
<h5 id="mcetoc_1eca2dc8a48">Step 2: Stop All Services on AWS Instance</h5>
<p>The purpose of this step is to make sure no process keeps some files in locked state which may fail step 4. Like sometimes MongoDB or PostgreSQL may lock files that prevent it from copying. So List all services and Stop all of them</p>
<p class="align-center"><span style="color: #e03e2d;"><strong>"Do not stop ssh service"</strong></span></p>
<h5 id="mcetoc_1eca2dc8a49">Step 3: Create Azure Virtual Machine with same version of Ubuntu as AWS</h5>
<p> </p>
<h5 id="mcetoc_1eca2dc8a4a">Step 4: Start the migration</h5>
<table style="border-collapse: collapse; background-color: #000000; border-color: #3598db; border-style: outset; height: 121px;" width="1047">
<tbody>
<tr>
<th style="width: 721.6px;"><span style="color: #2dc26b;">rsync -ahPHAXx --delete --exclude={/dev/*,/proc/*,/sys/*,/run/*,/mnt/*,/media/*,/lost+found,/boot,/etc/fstab,/swapfile} -e "ssh -i /home/ubuntu/instanceKey.pem" root@ec2-54-299-20-38.ap-southeast-1.compute.amazonaws.com:/ /</span></th>
</tr>
</tbody>
</table>
<h5 id="mcetoc_1eca2dc8a4b">Step 5: Install Azure Kernel</h5>
<table style="border-collapse: collapse; background-color: #000000; border-color: #3598db; border-style: outset; height: 121px;" width="1047">
<tbody>
<tr>
<th style="width: 721.6px;"><span style="color: #2dc26b;">sudo apt-get install linux-modules-5.0.0-1036-azure linux-image-5.0.0-1036-azure linux-azure linux-image-azure linux-azure-headers-5.0.0-1036 linux-headers-5.0.0-1036-azure linux-headers-azure linux-azure-tools-5.0.0-1036 linux-tools-5.0.0-1036-azure linux-tools-azure linux-azure-cloud-tools-5.0.0-1036 linux-cloud-tools-5.0.0-1036-azure linux-cloud-tools-azure</span></th>
</tr>
</tbody>
</table>
<p><strong>For VMWare Install Generic Kernel</strong></p>
<table style="border-collapse: collapse; background-color: #000000; border-color: #3598db; border-style: outset; height: 10px;" width="699">
<tbody>
<tr>
<th style="width: 700.8px;"><span style="color: #2dc26b;">sudo apt-get install --install-recommends linux-generic-hwe-18.04</span></th>
</tr>
</tbody>
</table>
<h5 id="mcetoc_1eca2dc8a4c">Step 6: Perform Cleanup</h5>
<p>AWS Systems Manager Agent (SSM Agent) is Amazon software that can be installed and configured on an EC2 instance.[1]</p>
<table style="border-collapse: collapse; background-color: #000000; border-color: #3598db; border-style: outset; height: 40px;" width="694">
<tbody>
<tr>
<th style="width: 700.8px;"><span style="color: #2dc26b;">sudo snap remove amazon-ssm-agent</span></th>
</tr>
</tbody>
</table>
<h5 id="mcetoc_1eca2dc8a4d">Step 7: Azure Agent</h5>
<p>The Microsoft Azure Linux Agent (waagent) manages Linux &amp; FreeBSD provisioning, and VM interaction with the Azure Fabric Controller.[2]</p>
<table style="border-collapse: collapse; background-color: #000000; border-color: #3598db; border-style: outset; height: 40px;" width="694">
<tbody>
<tr>
<th style="width: 700.8px;"><span style="color: #2dc26b;">sudo apt-get install walinuxagent</span></th>
</tr>
</tbody>
</table>
<h4 id="mcetoc_1eca0bf8f2p">References</h4>
<p>[1] <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/ssm-agent.html">https://docs.aws.amazon.com/systems-manager/latest/userguide/ssm-agent.html</a></p>
<p>[2] <a href="https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/agent-linux">https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/agent-linux</a></p>
<h4 id="mcetoc_1eca5jfib4p">Contact Me</h4>
<p>If you find errors in this Article or want to contribute to make this article better or just want to provide feedback, please contact me. I am new to blogging so excuse my noob mistakes.</p>
<h4>Document History</h4>
<table style="border-collapse: collapse; width: 100%;" border="1">
<tbody>
<tr>
<td style="width: 11.6808%;"><strong>Version</strong></td>
<td style="width: 43.4473%;"><strong>Changes</strong></td>
<td style="width: 44.8718%;"><strong>Remark</strong></td>
</tr>
<tr>
<td style="width: 11.6808%;">0.1</td>
<td style="width: 43.4473%;">Just started this document. May change in time.</td>
<td style="width: 44.8718%;">Just started. Work in progress. Next Version Elaborate Step 4 and 7. Also Correct Grammer.</td>
</tr>
</tbody>
</table>
<p> </p>
            ]]>
        </content>
    </entry>
    <entry>
        <title>Why start a blog now?</title>
        <author>
            <name>Anindya Biswas</name>
        </author>
        <link href="http://anindyabiswas.io/why-start-a-blog-now.html"/>
        <id>http://anindyabiswas.io/why-start-a-blog-now.html</id>
            <category term="General Thoughts"/>

        <updated>2020-07-03T16:44:07+05:30</updated>
            <summary>
                <![CDATA[
                    I used to write when I was a bit younger small poems to girls I used to like or something about what made me feel sad or happy. Over the years the habit of writing somehow went away. It was a job it was something&hellip;
                ]]>
            </summary>
        <content type="html">
            <![CDATA[
                <div class="" data-block="true" data-editor="9nbpd" data-offset-key="6kb6e-0-0">
<div class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr" data-offset-key="6kb6e-0-0"><span data-offset-key="6kb6e-0-0">I used to write when I was a bit younger small poems to girls I used to like or something about what made me feel sad or happy. Over the years the habit of writing somehow went away. It was a job it was something else but Yeah I stopped Writing. </span></div>
</div>
<div class="" data-block="true" data-editor="9nbpd" data-offset-key="atg2b-0-0">
<div class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr" data-offset-key="atg2b-0-0"><span data-offset-key="atg2b-0-0"> </span></div>
</div>
<div class="" data-block="true" data-editor="9nbpd" data-offset-key="6t8t-0-0">
<div class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr" data-offset-key="6t8t-0-0"><span data-offset-key="6t8t-0-0">With the SARS-CoV-2 situation, and staying locked in the house for months now. I thought lets get back into the habit of writing again. I have had 2 months of looking inwards trying to figure things out. I should write about it. The intended audience of this is I kind of like a diary.</span></div>
</div>
<div class="" data-block="true" data-editor="9nbpd" data-offset-key="ack2n-0-0">
<div class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr" data-offset-key="ack2n-0-0"><span data-offset-key="ack2n-0-0"> </span></div>
</div>
<div class="" data-block="true" data-editor="9nbpd" data-offset-key="3r7e3-0-0">
<div class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr" data-offset-key="3r7e3-0-0"><span data-offset-key="3r7e3-0-0">So I am starting this Blog. This time it is not going to be about stupid little poems for girls but about things I love or challenges I faced.</span></div>
</div>
<div class="" data-block="true" data-editor="9nbpd" data-offset-key="ef7b2-0-0">
<div class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr" data-offset-key="ef7b2-0-0"><span data-offset-key="ef7b2-0-0"> </span></div>
</div>
<div class="" data-block="true" data-editor="9nbpd" data-offset-key="ficps-0-0">
<div class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr" data-offset-key="ficps-0-0"><span data-offset-key="ficps-0-0">Some of the categories I am going to write about are:</span></div>
</div>
<ul class="public-DraftStyleDefault-ul" data-offset-key="8b4bh-0-0">
<li class="public-DraftStyleDefault-unorderedListItem public-DraftStyleDefault-reset public-DraftStyleDefault-depth0 public-DraftStyleDefault-listLTR" data-block="true" data-editor="9nbpd" data-offset-key="8b4bh-0-0">
<div class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr" data-offset-key="8b4bh-0-0"><span data-offset-key="8b4bh-0-0">Gaming</span></div>
</li>
<li class="public-DraftStyleDefault-unorderedListItem public-DraftStyleDefault-depth0 public-DraftStyleDefault-listLTR" data-block="true" data-editor="9nbpd" data-offset-key="a1c6d-0-0">
<div class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr" data-offset-key="a1c6d-0-0"><span data-offset-key="a1c6d-0-0">Technology Related</span></div>
</li>
<li class="public-DraftStyleDefault-unorderedListItem public-DraftStyleDefault-depth0 public-DraftStyleDefault-listLTR" data-block="true" data-editor="9nbpd" data-offset-key="720h4-0-0">
<div class="public-DraftStyleDefault-block public-DraftStyleDefault-ltr" data-offset-key="720h4-0-0"><span data-offset-key="720h4-0-0">Fun Projects I worked on</span></div>
</li>
</ul>
<p><span style="color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);">Let's see how it goes so stay tuned.</span></p>
            ]]>
        </content>
    </entry>
</feed>
