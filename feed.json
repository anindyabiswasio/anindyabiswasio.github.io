{
    "version": "https://jsonfeed.org/version/1",
    "title": "anindyabiswas.io",
    "description": "",
    "home_page_url": "http://anindyabiswas.io",
    "feed_url": "http://anindyabiswas.io/feed.json",
    "user_comment": "",
    "author": {
        "name": "Anindya Biswas"
    },
    "items": [
        {
            "id": "http://anindyabiswas.io/aws-ubuntu-instance-to-azure-or-vmware-migration.html",
            "url": "http://anindyabiswas.io/aws-ubuntu-instance-to-azure-or-vmware-migration.html",
            "title": "AWS Ubuntu 18.04 Instance to Azure or VMWare Migration or Any Other Virtualization",
            "summary": "Story So FarThe company I work for uses AWS as a primary cloud provider. The product that I worked on is a tool that made Mobile applications. Now when we started getting Corporate/Enterprise customers, They started to ask for On-Premises deployment on either a VMWare Environment, Nutanix Enterprise Cloud,&hellip;",
            "content_html": "<div class=\"post__toc\">\n<h3>Table of Contents</h3>\n<ul>\n<li><a href=\"#mcetoc_1eca0ciqp2r\">Story So Far</a></li>\n<li><a href=\"#mcetoc_1eca17npv30\">The Process</a>\n<ul>\n<li><a href=\"#mcetoc_1eca2a6sa35\">Step 1: Enable Root Access of AWS Instance via SSH</a></li>\n<li><a href=\"#mcetoc_1eca2dc8a48\">Step 2: Stop All Services on AWS Instance</a></li>\n<li><a href=\"#mcetoc_1eca2dc8a49\">Step 3: Create Azure Virtual Machine or VMWare</a></li>\n<li><a href=\"#mcetoc_1eca2dc8a4a\">Step 4: Start the migration</a></li>\n<li><a href=\"#mcetoc_1eca2dc8a4b\">Step 5: Install Azure Kernel</a></li>\n<li><a href=\"#mcetoc_1eca2dc8a4c\">Step 6: Perform Cleanup</a></li>\n<li><a href=\"#mcetoc_1eca2dc8a4d\">Step 7: Azure Agent</a></li>\n</ul>\n</li>\n<li><a href=\"#mcetoc_1eca0bf8f2p\">References</a></li>\n<li><a href=\"#mcetoc_1eca5jfib4p\">Contact Me</a></li>\n<li><a href=\"#mcetoc_1eca6qchr5c\">Document History</a></li>\n</ul>\n</div>\n<h4 id=\"mcetoc_1eca0ciqp2r\">Story So Far</h4>\n<p><span data-preserver-spaces=\"true\">The company I work for uses AWS as a primary cloud provider. The product that I worked on is a tool that made Mobile applications. Now when we started getting Corporate/Enterprise customers, They started to ask for On-Premises deployment on either a </span><strong><span data-preserver-spaces=\"true\">VMWare</span></strong><span data-preserver-spaces=\"true\"> Environment, </span><strong><span data-preserver-spaces=\"true\">Nutanix</span></strong><span data-preserver-spaces=\"true\"> Enterprise Cloud, or on their Azure Instances in their accounts. Some organizations used AWS so it was easy, we would just share the AMI for the AWS Images and be done with it. However, the challenge was when they wanted deployments of production on their cloud or On-premises solutions. </span></p>\n<p><span data-preserver-spaces=\"true\">After failing a few times I found a way to reliably moving around across any Virtualization System.</span></p>\n<h4 id=\"mcetoc_1eca17npv30\">The Process</h4>\n<p><span data-preserver-spaces=\"true\">The idea behind this is a simple one. We just copy all the files in the root (/) from a </span><strong><span data-preserver-spaces=\"true\">Source</span></strong><span data-preserver-spaces=\"true\"> instance to </span><strong><span data-preserver-spaces=\"true\">Destination </span></strong><span data-preserver-spaces=\"true\">Instance.</span></p>\n<p><span data-preserver-spaces=\"true\">Here are the steps I performed.</span></p>\n<h5 id=\"mcetoc_1eca2a6sa35\">Step 1: Enable Root Access of AWS Instance via SSH</h5>\n<p><span data-preserver-spaces=\"true\">On AWS </span><strong><span data-preserver-spaces=\"true\">\"root user\"</span></strong><span data-preserver-spaces=\"true\"> access is restricted via SSH and this is done on purpose for security reasons. However, we require root access as we will be copying system-level files.</span></p>\n<p><span data-preserver-spaces=\"true\">To do this we must do 3 things.</span></p>\n<ul style=\"list-style-type: square;\">\n<li><strong>Copy .ssh folder</strong> from Logged in User to /root folder, the purpose for this is to have the same key we use to login.</li>\n</ul>\n<table style=\"border-collapse: collapse; background-color: #000000; border-color: #3598db; border-style: outset; height: 10px;\" width=\"699\">\n<tbody>\n<tr>\n<th style=\"width: 700.8px;\"><span style=\"color: #2dc26b;\">sudo cp -R .ssh /root</span></th>\n</tr>\n</tbody>\n</table>\n<ul style=\"list-style-type: square;\">\n<li>Edit <strong>/etc/ssh/sshd_config</strong></li>\n</ul>\n<table style=\"border-collapse: collapse; background-color: #000000; border-color: #3598db; border-style: outset; height: 10px;\" width=\"699\">\n<tbody>\n<tr>\n<th style=\"width: 700.8px;\"><span style=\"color: #2dc26b;\">sudo sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/' /etc/ssh/sshd_config</span></th>\n</tr>\n</tbody>\n</table>\n<ul style=\"list-style-type: square;\">\n<li>Restart <strong>SSH Service</strong></li>\n</ul>\n<table style=\"border-collapse: collapse; background-color: #000000; border-color: #3598db; border-style: outset; height: 10px;\" width=\"699\">\n<tbody>\n<tr>\n<th style=\"width: 700.8px;\"><span style=\"color: #2dc26b;\">sudo service ssh restart</span></th>\n</tr>\n</tbody>\n</table>\n<p>That should be it.</p>\n<h5 id=\"mcetoc_1eca2dc8a48\">Step 2: Stop All Services on AWS Instance</h5>\n<p>The purpose of this step is to make sure no process keeps some files in a locked state which may fail step 4. Like sometimes MongoDB or PostgreSQL may lock files that prevent it from copying. So List all services and Stop all of them.</p>\n<p class=\"align-center\"><span style=\"color: #e03e2d;\"><strong>\"Do not stop ssh service\"</strong></span></p>\n<h5 id=\"mcetoc_1eca2dc8a49\">Step 3: Create Azure Virtual Machine or VMWare</h5>\n<p>Here we want to create a Virtual Machine on either Azure or VMware. For VMWare I created a VMWare Workstation Image with Ubuntu 18.04 update it and rebooted it. The core idea is the system should be as close to the AWS Instance as possible in terms of updates. Not that it matters much as next step will remove everything you just installed.</p>\n<h5 id=\"mcetoc_1eca2dc8a4a\">Step 4: Start the migration</h5>\n<p>This process is for the actual migration of the user instance from AWS to Azure/VMWare. </p>\n<p>First we Upload the instance Key that we use to login to AWS to Azure/VMWare.</p>\n<p>Second we run this command to start the Syncing do not copy paste it, the explanation is below</p>\n<table style=\"border-collapse: collapse; background-color: #000000; border-color: #3598db; border-style: outset; height: 121px;\" width=\"1047\">\n<tbody>\n<tr>\n<th style=\"width: 721.6px;\"><span style=\"color: #2dc26b;\">rsync -ahPHAXx --delete --exclude={/dev/*,/proc/*,/sys/*,/run/*,/mnt/*,/media/*,/lost+found,/boot,/etc/fstab,/swapfile} -e \"ssh -i /home/ubuntu/instanceKey.pem\" root@ec2-54-299-20-38.ap-southeast-1.compute.amazonaws.com:/ /</span></th>\n</tr>\n</tbody>\n</table>\n<p><strong>Command Explained <sup>[1]</sup></strong></p>\n<p><code>--delete                delete extraneous files from dest dirs</code></p>\n<p><strong>Purpose</strong>: We delete all files that don't belong to source AWS Instance FS.</p>\n<p><code>--exclude=PATTERN       exclude files matching PATTERN</code></p>\n<p><strong>Purpose</strong>: We delete all files except these files.</p>\n<p><code>-e, --rsh=COMMAND           specify the remote shell to use</code></p>\n<p><strong>Purpose</strong>: <span style=\"color: #000000;\">We use the command for Remote Connection. In our case it is :</span></p>\n<table style=\"border-collapse: collapse; width: 100%; height: 174px;\" border=\"1\">\n<tbody>\n<tr style=\"height: 174px;\">\n<td style=\"width: 100%; height: 174px;\">\n<p>\"ssh -i /home/ubuntu/instanceKey.pem\" <a href=\"mailto:root@ec2-54-299-20-38.ap-southeast-1.compute.amazonaws.com:/\">root@ec2-54-299-20-38.ap-southeast-1.compute.amazonaws.com:/</a></p>\n<p>SSH Key: instanceKey.pem</p>\n<p>Instance IP: ec2-54-299-20-38.ap-southeast-1.compute.amazonaws.com</p>\n<p>The :/ at the end means start rsync from /</p>\n</td>\n</tr>\n</tbody>\n</table>\n<h5 id=\"mcetoc_1eca2dc8a4b\">Step 5: Install Azure/VMWare Kernel</h5>\n<p>This step is actually very important if you want a bootable VM. In the previous command your boot configuration is corrupt as rsync has removed most of the configuration. To fix this we need to reinstall the kernel which will configure grub boot-loader.</p>\n<p><strong>Azure Kernel</strong></p>\n<table style=\"border-collapse: collapse; background-color: #000000; border-color: #3598db; border-style: outset; height: 121px;\" width=\"1047\">\n<tbody>\n<tr>\n<th style=\"width: 721.6px;\"><span style=\"color: #2dc26b;\">sudo apt-get install linux-modules-5.0.0-1036-azure linux-image-5.0.0-1036-azure linux-azure linux-image-azure linux-azure-headers-5.0.0-1036 linux-headers-5.0.0-1036-azure linux-headers-azure linux-azure-tools-5.0.0-1036 linux-tools-5.0.0-1036-azure linux-tools-azure linux-azure-cloud-tools-5.0.0-1036 linux-cloud-tools-5.0.0-1036-azure linux-cloud-tools-azure</span></th>\n</tr>\n</tbody>\n</table>\n<p><strong>For VMWare Install Generic Kernel</strong></p>\n<table style=\"border-collapse: collapse; background-color: #000000; border-color: #3598db; border-style: outset; height: 10px;\" width=\"699\">\n<tbody>\n<tr>\n<th style=\"width: 700.8px;\"><span style=\"color: #2dc26b;\">sudo apt-get install --install-recommends linux-generic-hwe-18.04</span></th>\n</tr>\n</tbody>\n</table>\n<h5 id=\"mcetoc_1eca2dc8a4c\">Step 6: Perform Cleanup</h5>\n<p>AWS Systems Manager Agent (SSM Agent) is Amazon software that can be installed and configured on an EC2 instance.<sup>[2]</sup></p>\n<table style=\"border-collapse: collapse; background-color: #000000; border-color: #3598db; border-style: outset; height: 40px;\" width=\"694\">\n<tbody>\n<tr>\n<th style=\"width: 700.8px;\"><span style=\"color: #2dc26b;\">sudo snap remove amazon-ssm-agent</span></th>\n</tr>\n</tbody>\n</table>\n<h5 id=\"mcetoc_1eca2dc8a4d\">Step 7: Azure Agent</h5>\n<p>The Microsoft Azure Linux Agent (waagent) manages Linux &amp; FreeBSD provisioning, and VM interaction with the Azure Fabric Controller.<sup>[3]</sup></p>\n<table style=\"border-collapse: collapse; background-color: #000000; border-color: #3598db; border-style: outset; height: 40px;\" width=\"694\">\n<tbody>\n<tr>\n<th style=\"width: 700.8px;\"><span style=\"color: #2dc26b;\">sudo apt-get install walinuxagent</span></th>\n</tr>\n</tbody>\n</table>\n<h4 id=\"mcetoc_1eca0bf8f2p\">References</h4>\n<p>[1] <a href=\"https://www.man7.org/linux/man-pages/man1/rsync.1.html\">https://www.man7.org/linux/man-pages/man1/rsync.1.html</a></p>\n<p>[2] <a href=\"https://docs.aws.amazon.com/systems-manager/latest/userguide/ssm-agent.html\">https://docs.aws.amazon.com/systems-manager/latest/userguide/ssm-agent.html</a></p>\n<p>[3] <a href=\"https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/agent-linux\">https://docs.microsoft.com/en-us/azure/virtual-machines/extensions/agent-linux</a></p>\n<h4 id=\"mcetoc_1eca5jfib4p\">Contact Me</h4>\n<p>If you find errors in this Article or want to contribute to make this article better or just want to provide feedback, please contact me. I am new to blogging so excuse my noob mistakes.</p>\n<h4 id=\"mcetoc_1eca6qchr5c\">Document History</h4>\n<table style=\"border-collapse: collapse; width: 100%;\" border=\"1\">\n<tbody>\n<tr>\n<td style=\"width: 11.6808%;\"><strong>Version</strong></td>\n<td style=\"width: 43.4473%;\"><strong>Changes</strong></td>\n<td style=\"width: 44.8718%;\"><strong>Remark</strong></td>\n</tr>\n<tr>\n<td style=\"width: 11.6808%;\">0.1</td>\n<td style=\"width: 43.4473%;\">Just started this document. May change in time.</td>\n<td style=\"width: 44.8718%;\">Just started. Work in progress. Next Version Elaborate Step 4 and 7. Also Correct Grammer.</td>\n</tr>\n<tr>\n<td style=\"width: 11.6808%;\">0.2</td>\n<td style=\"width: 43.4473%;\">Made a few more additions</td>\n<td style=\"width: 44.8718%;\"> </td>\n</tr>\n</tbody>\n</table>\n<p> </p>",
            "author": {
                "name": "Anindya Biswas"
            },
            "tags": [
                   "Linux",
                   "Cloud Computing"
            ],
            "date_published": "2020-07-03T19:58:12+05:30",
            "date_modified": "2020-07-03T19:58:12+05:30"
        },
        {
            "id": "http://anindyabiswas.io/why-start-a-blog-now.html",
            "url": "http://anindyabiswas.io/why-start-a-blog-now.html",
            "title": "Why start a blog now?",
            "summary": "I used to write when I was a bit younger small poems to girls I used to like or something about what made me feel sad or happy. Over the years the habit of writing somehow went away. It was a job it was something&hellip;",
            "content_html": "<div class=\"\" data-block=\"true\" data-editor=\"9nbpd\" data-offset-key=\"6kb6e-0-0\">\n<div class=\"public-DraftStyleDefault-block public-DraftStyleDefault-ltr\" data-offset-key=\"6kb6e-0-0\"><span data-offset-key=\"6kb6e-0-0\">I used to write when I was a bit younger small poems to girls I used to like or something about what made me feel sad or happy. Over the years the habit of writing somehow went away. It was a job it was something else but Yeah I stopped Writing. </span></div>\n</div>\n<div class=\"\" data-block=\"true\" data-editor=\"9nbpd\" data-offset-key=\"atg2b-0-0\">\n<div class=\"public-DraftStyleDefault-block public-DraftStyleDefault-ltr\" data-offset-key=\"atg2b-0-0\"><span data-offset-key=\"atg2b-0-0\"> </span></div>\n</div>\n<div class=\"\" data-block=\"true\" data-editor=\"9nbpd\" data-offset-key=\"6t8t-0-0\">\n<div class=\"public-DraftStyleDefault-block public-DraftStyleDefault-ltr\" data-offset-key=\"6t8t-0-0\"><span data-offset-key=\"6t8t-0-0\">With the SARS-CoV-2 situation, and staying locked in the house for months now. I thought lets get back into the habit of writing again. I have had 2 months of looking inwards trying to figure things out. I should write about it. The intended audience of this is I kind of like a diary.</span></div>\n</div>\n<div class=\"\" data-block=\"true\" data-editor=\"9nbpd\" data-offset-key=\"ack2n-0-0\">\n<div class=\"public-DraftStyleDefault-block public-DraftStyleDefault-ltr\" data-offset-key=\"ack2n-0-0\"><span data-offset-key=\"ack2n-0-0\"> </span></div>\n</div>\n<div class=\"\" data-block=\"true\" data-editor=\"9nbpd\" data-offset-key=\"3r7e3-0-0\">\n<div class=\"public-DraftStyleDefault-block public-DraftStyleDefault-ltr\" data-offset-key=\"3r7e3-0-0\"><span data-offset-key=\"3r7e3-0-0\">So I am starting this Blog. This time it is not going to be about stupid little poems for girls but about things I love or challenges I faced.</span></div>\n</div>\n<div class=\"\" data-block=\"true\" data-editor=\"9nbpd\" data-offset-key=\"ef7b2-0-0\">\n<div class=\"public-DraftStyleDefault-block public-DraftStyleDefault-ltr\" data-offset-key=\"ef7b2-0-0\"><span data-offset-key=\"ef7b2-0-0\"> </span></div>\n</div>\n<div class=\"\" data-block=\"true\" data-editor=\"9nbpd\" data-offset-key=\"ficps-0-0\">\n<div class=\"public-DraftStyleDefault-block public-DraftStyleDefault-ltr\" data-offset-key=\"ficps-0-0\"><span data-offset-key=\"ficps-0-0\">Some of the categories I am going to write about are:</span></div>\n</div>\n<ul class=\"public-DraftStyleDefault-ul\" data-offset-key=\"8b4bh-0-0\">\n<li class=\"public-DraftStyleDefault-unorderedListItem public-DraftStyleDefault-reset public-DraftStyleDefault-depth0 public-DraftStyleDefault-listLTR\" data-block=\"true\" data-editor=\"9nbpd\" data-offset-key=\"8b4bh-0-0\">\n<div class=\"public-DraftStyleDefault-block public-DraftStyleDefault-ltr\" data-offset-key=\"8b4bh-0-0\"><span data-offset-key=\"8b4bh-0-0\">Gaming</span></div>\n</li>\n<li class=\"public-DraftStyleDefault-unorderedListItem public-DraftStyleDefault-depth0 public-DraftStyleDefault-listLTR\" data-block=\"true\" data-editor=\"9nbpd\" data-offset-key=\"a1c6d-0-0\">\n<div class=\"public-DraftStyleDefault-block public-DraftStyleDefault-ltr\" data-offset-key=\"a1c6d-0-0\"><span data-offset-key=\"a1c6d-0-0\">Technology Related</span></div>\n</li>\n<li class=\"public-DraftStyleDefault-unorderedListItem public-DraftStyleDefault-depth0 public-DraftStyleDefault-listLTR\" data-block=\"true\" data-editor=\"9nbpd\" data-offset-key=\"720h4-0-0\">\n<div class=\"public-DraftStyleDefault-block public-DraftStyleDefault-ltr\" data-offset-key=\"720h4-0-0\"><span data-offset-key=\"720h4-0-0\">Fun Projects I worked on</span></div>\n</li>\n</ul>\n<p><span style=\"color: var(--text-editor-body-color); font-family: var(--font-base); font-size: inherit; font-weight: var(--font-weight-normal);\">Let's see how it goes so stay tuned.</span></p>",
            "author": {
                "name": "Anindya Biswas"
            },
            "tags": [
                   "General Thoughts"
            ],
            "date_published": "2020-07-03T19:58:12+05:30",
            "date_modified": "2020-07-03T19:58:12+05:30"
        }
    ]
}
